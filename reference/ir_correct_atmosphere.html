<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Corrects artifacts in a spectrum based on reference spectra of the artifact compound — ir_correct_atmosphere • ir</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Corrects artifacts in a spectrum based on reference spectra of the artifact compound — ir_correct_atmosphere"><meta name="description" content="ir_correct_atmosphere takes two objects of class ir with the same number
of spectra in each and corrects the spectra of the first object with the
spectra of the second object according to the procedure presented by
Perez-Guaita.2013ir."><meta property="og:description" content="ir_correct_atmosphere takes two objects of class ir with the same number
of spectra in each and corrects the spectra of the first object with the
spectra of the second object according to the procedure presented by
Perez-Guaita.2013ir."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ir</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/ir-introduction.html">Introduction to the 'ir' package</a></li>
    <li><a class="dropdown-item" href="../articles/ir-class.html">Introduction to the `ir`class</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><a class="dropdown-item" href="../news/index.html">News</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/henningte/ir/" aria-label="View on GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Corrects artifacts in a spectrum based on reference spectra of the artifact compound</h1>
      <small class="dont-index">Source: <a href="https://github.com/henningte/ir/blob/main/R/ir_correct_atmosphere.R" class="external-link"><code>R/ir_correct_atmosphere.R</code></a></small>
      <div class="d-none name"><code>ir_correct_atmosphere.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>ir_correct_atmosphere</code> takes two objects of class <code>ir</code> with the same number
of spectra in each and corrects the spectra of the first object with the
spectra of the second object according to the procedure presented by
Perez-Guaita.2013ir.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ir_correct_atmosphere</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">ref</span>,</span>
<span>  <span class="va">wn1</span>,</span>
<span>  <span class="va">wn2</span>,</span>
<span>  return_contribution <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  do_interpolate <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  dw <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  return_ir_flat <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p></p>
    </div>
    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code><a href="ir_new_ir.html">ir</a></code> containing the spectra to
correct (with intensities representing absorbances).</p></dd>


<dt id="arg-ref">ref<a class="anchor" aria-label="anchor" href="#arg-ref"></a></dt>
<dd><p>An object of class <code><a href="ir_new_ir.html">ir</a></code> containing the reference
spectra to use for correction  (with intensities representing absorbances).
<code>ref</code> must have the same number of rows as <code>x</code>, the contained spectra must
cover the wavenumber range of all spectra in <code>x</code>, and if
<code>do_interpolate = FALSE</code>, all spectra must have identical wavenumber values.</p></dd>


<dt id="arg-wn-">wn1<a class="anchor" aria-label="anchor" href="#arg-wn-"></a></dt>
<dd><p>A numeric value representing the first wavenumber value to use as
reference point Perez-Guaita.2013ir. Examples used by
Perez-Guaita.2013;textualir are:</p><dl><dt>H\(_2\)O</dt>
<dd><p>3902 cm\(^{-1}\).</p></dd>

<dt>CO\(_2\)</dt>
<dd><p>2361 cm\(^{-1}\).</p></dd>


</dl></dd>


<dt id="arg-wn-">wn2<a class="anchor" aria-label="anchor" href="#arg-wn-"></a></dt>
<dd><p>A numeric value representing the second wavenumber value to use as
reference point Perez-Guaita.2013ir. Examples used by
Perez-Guaita.2013;textualir are:</p><dl><dt>H\(_2\)O</dt>
<dd><p>3912 cm\(^{-1}\).</p></dd>

<dt>CO\(_2\)</dt>
<dd><p>2349 cm\(^{-1}\).</p></dd>


</dl></dd>


<dt id="arg-return-contribution">return_contribution<a class="anchor" aria-label="anchor" href="#arg-return-contribution"></a></dt>
<dd><p>A logical value indicating whether in addition to
the corrected spectra, the computed relative contribution of <code>ref</code> to each
spectrum in <code>x</code> should be added to the returned object as new column
<code>contribution</code> (<code>TRUE</code>) or not (<code>FALSE</code>).</p></dd>


<dt id="arg-do-interpolate">do_interpolate<a class="anchor" aria-label="anchor" href="#arg-do-interpolate"></a></dt>
<dd><p>A logical value indicating if <code>x</code> and <code>ref</code> should be
interpolated prior correction (<code>TRUE</code>) or not (<code>FALSE</code>).</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>See <code><a href="ir_interpolate.html">ir_interpolate()</a></code>.</p></dd>


<dt id="arg-dw">dw<a class="anchor" aria-label="anchor" href="#arg-dw"></a></dt>
<dd><p>See <code><a href="ir_interpolate.html">ir_interpolate()</a></code>.</p></dd>


<dt id="arg-warn">warn<a class="anchor" aria-label="anchor" href="#arg-warn"></a></dt>
<dd><p>A logical value indicating whether warnings about mismatching
wavenumber values should be displayed (<code>TRUE</code>) or not (<code>FALSE</code>). If set to
<code>TRUE</code> and <code>wn1</code> or <code>wn2</code> do not exactly match the wavenumber values in <code>x</code>
and <code>ref</code>, a warning will be printed to inform about the wavenumber
difference between the selected and targeted wavenumber value.</p></dd>


<dt id="arg-return-ir-flat">return_ir_flat<a class="anchor" aria-label="anchor" href="#arg-return-ir-flat"></a></dt>
<dd><p>Logical value. If <code>TRUE</code>, the spectra are returned as
<code><a href="ir_new_ir_flat.html">ir_flat</a></code> object.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>x</code> corrected with the reference spectra in <code>ref</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">ir_correct_atmosphere</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">ir_sample_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, <span class="va">ir_sample_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, wn1 <span class="op">=</span> <span class="fl">2361</span>, wn2 <span class="op">=</span> <span class="fl">2349</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">ir_correct_atmosphere</span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="va">ir_sample_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, <span class="va">ir_sample_data</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="op">]</span>, wn1 <span class="op">=</span> <span class="fl">2361</span>, wn2 <span class="op">=</span> <span class="fl">2349</span>,</span></span>
<span class="r-in"><span>    return_contribution <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x2</span><span class="op">$</span><span class="va">contribution</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 3 4 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 1 1 1 1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> attr(,"class")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "numeric"</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Henning Teickner.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

